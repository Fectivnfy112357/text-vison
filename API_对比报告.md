# å¾®ä¿¡å°ç¨‹åºå‰ç«¯APIè°ƒç”¨ä¸åç«¯æ¥å£å¯¹æ¯”æŠ¥å‘Š

## æ¦‚è¿°
æœ¬æŠ¥å‘Šå¯¹æ¯”äº†å¾®ä¿¡å°ç¨‹åºå‰ç«¯é¡µé¢ä¸­è°ƒç”¨çš„APIæ¥å£ä¸åç«¯Controllerä¸­å®šä¹‰çš„æ¥å£ï¼Œè¯†åˆ«å‡ºä¸åŒ¹é…çš„é—®é¢˜å¹¶æä¾›ä¿®å¤å»ºè®®ã€‚

## å‰ç«¯APIè°ƒç”¨åˆ†æ

### 1. æ¨¡æ¿ç›¸å…³APIè°ƒç”¨
**æ–‡ä»¶**: `wxmini/pages/templates/templates.js`, `wxmini/pages/index/index.js`
- `api.template.getTemplates()` - è·å–æ¨¡æ¿åˆ—è¡¨
- `api.favoriteTemplate()` - æ”¶è—æ¨¡æ¿

**æ–‡ä»¶**: `wxmini/pages/create/create.js`
- `content.getTemplateDetail()` - è·å–æ¨¡æ¿è¯¦æƒ…

### 2. å†…å®¹ç”Ÿæˆç›¸å…³APIè°ƒç”¨
**æ–‡ä»¶**: `wxmini/pages/create/create.js`
- `content.textToImage()` - æ–‡æœ¬ç”Ÿæˆå›¾ç‰‡
- `content.textToVideo()` - æ–‡æœ¬ç”Ÿæˆè§†é¢‘
- `content.imageToImage()` - å›¾ç‰‡è½¬å›¾ç‰‡
- `content.getTaskStatus()` - è·å–ä»»åŠ¡çŠ¶æ€
- `content.getTaskResult()` - è·å–ä»»åŠ¡ç»“æœ

### 3. å†å²è®°å½•ç›¸å…³APIè°ƒç”¨
**æ–‡ä»¶**: `wxmini/pages/history/history.js`, `wxmini/pages/index/index.js`
- `api.getGenerationHistory()` - è·å–ç”Ÿæˆå†å²
- `api.getGenerationStatistics()` - è·å–ç”Ÿæˆç»Ÿè®¡
- `api.deleteGenerationHistory()` - åˆ é™¤ç”Ÿæˆå†å²
- `history.getHistoryList()` - è·å–å†å²åˆ—è¡¨

### 4. ç”¨æˆ·ç›¸å…³APIè°ƒç”¨
**æ–‡ä»¶**: `wxmini/pages/account/account.js`
- `auth.changePassword()` - ä¿®æ”¹å¯†ç 

**æ–‡ä»¶**: `wxmini/pages/profile/profile.js`
- `user.getUserStats()` - è·å–ç”¨æˆ·ç»Ÿè®¡
- `user.getMemberInfo()` - è·å–ä¼šå‘˜ä¿¡æ¯

**æ–‡ä»¶**: `wxmini/pages/login/login.js`
- `auth.wxLogin()` - å¾®ä¿¡ç™»å½•

## åç«¯æ¥å£å®šä¹‰åˆ†æ

### 1. æ¨¡æ¿æ§åˆ¶å™¨ (TemplateController)
**è·¯å¾„**: `/api/templates`
- `GET /api/templates` - åˆ†é¡µæŸ¥è¯¢æ¨¡æ¿
- `GET /api/templates/{id}` - è·å–æ¨¡æ¿è¯¦æƒ…
- `GET /api/templates/categories` - è·å–æ‰€æœ‰åˆ†ç±»
- `GET /api/templates/popular` - è·å–çƒ­é—¨æ¨¡æ¿
- `GET /api/templates/search` - æœç´¢æ¨¡æ¿
- `GET /api/templates/by-tag` - æ ¹æ®æ ‡ç­¾æŸ¥è¯¢æ¨¡æ¿
- `POST /api/templates/{id}/use` - ä½¿ç”¨æ¨¡æ¿

### 2. å†…å®¹ç”Ÿæˆæ§åˆ¶å™¨ (GeneratedContentController)
**è·¯å¾„**: `/api/contents`
- `POST /api/contents/generate` - ç”Ÿæˆå†…å®¹
- `GET /api/contents` - åˆ†é¡µæŸ¥è¯¢ç”¨æˆ·ç”Ÿæˆå†…å®¹
- `GET /api/contents/{id}` - è·å–ç”Ÿæˆå†…å®¹è¯¦æƒ…
- `GET /api/contents/recent` - è·å–æœ€è¿‘ç”Ÿæˆå†…å®¹
- `DELETE /api/contents/{id}` - åˆ é™¤ç”Ÿæˆå†…å®¹
- `DELETE /api/contents/batch` - æ‰¹é‡åˆ é™¤ç”Ÿæˆå†…å®¹
- `GET /api/contents/stats` - è·å–ç”¨æˆ·ç”Ÿæˆç»Ÿè®¡
- `POST /api/contents/{id}/download` - ä¸‹è½½ç”Ÿæˆå†…å®¹

### 3. ç”¨æˆ·æ§åˆ¶å™¨ (UserController)
**è·¯å¾„**: `/api/users`
- `POST /api/users/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/users/login` - ç”¨æˆ·ç™»å½•
- `GET /api/users/profile` - è·å–ç”¨æˆ·ä¿¡æ¯
- `PUT /api/users/profile` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `PUT /api/users/password` - ä¿®æ”¹å¯†ç 
- `GET /api/users/check-email` - æ£€æŸ¥é‚®ç®±æ˜¯å¦å­˜åœ¨
- `GET /api/users/check-username` - æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨
- `GET /api/users/operation-logs` - è·å–ç”¨æˆ·æ“ä½œæ—¥å¿—

### 4. å¾®ä¿¡è®¤è¯æ§åˆ¶å™¨ (WxAuthController)
**è·¯å¾„**: `/api/auth`
- `POST /api/auth/wx-login` - å¾®ä¿¡å°ç¨‹åºç™»å½•
- `PUT /api/auth/wx-userinfo` - æ›´æ–°å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯
- `GET /api/auth/wx-status` - å¾®ä¿¡ç™»å½•çŠ¶æ€æ£€æŸ¥

### 5. æ¨¡æ¿åˆ†ç±»æ§åˆ¶å™¨ (TemplateCategoryController)
**è·¯å¾„**: `/api/template-categories`
- `GET /api/template-categories` - è·å–æ‰€æœ‰å¯ç”¨åˆ†ç±»
- `GET /api/template-categories/names` - è·å–åˆ†ç±»åç§°åˆ—è¡¨
- `GET /api/template-categories/{id}` - æ ¹æ®IDè·å–åˆ†ç±»è¯¦æƒ…
- `POST /api/template-categories` - åˆ›å»ºæ–°åˆ†ç±»
- `PUT /api/template-categories/{id}` - æ›´æ–°åˆ†ç±»ä¿¡æ¯
- `DELETE /api/template-categories/{id}` - åˆ é™¤åˆ†ç±»
- `PUT /api/template-categories/sort` - æ›´æ–°åˆ†ç±»æ’åº

### 6. è‰ºæœ¯é£æ ¼æ§åˆ¶å™¨ (ArtStyleController)
**è·¯å¾„**: `/api/art-styles`
- `GET /api/art-styles` - è·å–æ‰€æœ‰è‰ºæœ¯é£æ ¼
- `GET /api/art-styles/{id}` - æ ¹æ®IDè·å–è‰ºæœ¯é£æ ¼è¯¦æƒ…
- `POST /api/art-styles` - åˆ›å»ºæ–°è‰ºæœ¯é£æ ¼
- `PUT /api/art-styles/{id}` - æ›´æ–°è‰ºæœ¯é£æ ¼ä¿¡æ¯
- `DELETE /api/art-styles/{id}` - åˆ é™¤è‰ºæœ¯é£æ ¼

## å‘ç°çš„é—®é¢˜

### ğŸ”´ ä¸¥é‡é—®é¢˜

#### 1. å‰ç«¯è°ƒç”¨ä¸å­˜åœ¨çš„æ¥å£
- **é—®é¢˜**: `api.favoriteTemplate()` - å‰ç«¯è°ƒç”¨æ”¶è—æ¨¡æ¿æ¥å£ï¼Œä½†åç«¯æ²¡æœ‰å¯¹åº”çš„æ¥å£å®šä¹‰
- **å½±å“**: æ”¶è—åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œ
- **ä¿®å¤å»ºè®®**: åœ¨åç«¯æ·»åŠ æ”¶è—æ¨¡æ¿ç›¸å…³çš„æ¥å£ï¼Œæˆ–è€…ç§»é™¤å‰ç«¯çš„æ”¶è—åŠŸèƒ½

#### 2. æ¥å£è·¯å¾„ä¸åŒ¹é…
- **é—®é¢˜**: å‰ç«¯è°ƒç”¨ `content.getTemplateDetail()` ä½†åç«¯æ¨¡æ¿è¯¦æƒ…æ¥å£æ˜¯ `GET /api/templates/{id}`
- **å½±å“**: è·å–æ¨¡æ¿è¯¦æƒ…å¯èƒ½å¤±è´¥
- **ä¿®å¤å»ºè®®**: ç¡®ä¿å‰ç«¯è°ƒç”¨æ­£ç¡®çš„æ¥å£è·¯å¾„

#### 3. å†…å®¹ç”Ÿæˆæ¥å£ä¸åŒ¹é…
- **é—®é¢˜**: å‰ç«¯è°ƒç”¨ `content.textToImage()`, `content.textToVideo()`, `content.imageToImage()` ç­‰å…·ä½“ç±»å‹çš„ç”Ÿæˆæ¥å£ï¼Œä½†åç«¯åªæœ‰ç»Ÿä¸€çš„ `POST /api/contents/generate` æ¥å£
- **å½±å“**: ä¸åŒç±»å‹çš„å†…å®¹ç”Ÿæˆå¯èƒ½æ— æ³•æ­£ç¡®è°ƒç”¨
- **ä¿®å¤å»ºè®®**: å‰ç«¯ç»Ÿä¸€ä½¿ç”¨ `content.generate()` æ¥å£ï¼Œé€šè¿‡å‚æ•°åŒºåˆ†ç”Ÿæˆç±»å‹

#### 4. ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢æ¥å£ç¼ºå¤±
- **é—®é¢˜**: å‰ç«¯è°ƒç”¨ `content.getTaskStatus()` å’Œ `content.getTaskResult()` ä½†åç«¯æ²¡æœ‰å¯¹åº”çš„æ¥å£
- **å½±å“**: æ— æ³•æŸ¥è¯¢ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€å’Œç»“æœ
- **ä¿®å¤å»ºè®®**: åç«¯æ·»åŠ ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢æ¥å£ï¼Œæˆ–è€…å‰ç«¯æ”¹ç”¨ `GET /api/contents/{id}` æ¥å£

#### 5. å†å²è®°å½•æ¥å£ä¸åŒ¹é…
- **é—®é¢˜**: å‰ç«¯è°ƒç”¨ `api.getGenerationHistory()`, `api.getGenerationStatistics()`, `api.deleteGenerationHistory()` å’Œ `history.getHistoryList()` ä½†åç«¯å¯¹åº”çš„æ¥å£è·¯å¾„ä¸åŒ
- **å½±å“**: å†å²è®°å½•åŠŸèƒ½å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ
- **ä¿®å¤å»ºè®®**: ç»Ÿä¸€å‰ç«¯APIè°ƒç”¨è·¯å¾„ä¸åç«¯æ¥å£è·¯å¾„

#### 6. ç”¨æˆ·ç»Ÿè®¡å’Œä¼šå‘˜ä¿¡æ¯æ¥å£ç¼ºå¤±
- **é—®é¢˜**: å‰ç«¯è°ƒç”¨ `user.getUserStats()` å’Œ `user.getMemberInfo()` ä½†åç«¯UserControllerä¸­æ²¡æœ‰å¯¹åº”æ¥å£
- **å½±å“**: ç”¨æˆ·ç»Ÿè®¡å’Œä¼šå‘˜ä¿¡æ¯æ— æ³•è·å–
- **ä¿®å¤å»ºè®®**: åç«¯æ·»åŠ ç”¨æˆ·ç»Ÿè®¡å’Œä¼šå‘˜ä¿¡æ¯æ¥å£

### ğŸŸ¡ å“åº”å­—æ®µä¸åŒ¹é…é—®é¢˜

#### 1. æ¨¡æ¿åˆ—è¡¨å“åº”å­—æ®µ
- **é—®é¢˜**: å‰ç«¯æœŸæœ› `response.data.list` ä½†åç«¯è¿”å› `PageResult` ç»“æ„ï¼Œå®é™…å­—æ®µæ˜¯ `response.data.records`
- **æ–‡ä»¶**: `wxmini/pages/templates/templates.js` ç¬¬85è¡Œ
- **ä¿®å¤å»ºè®®**: å‰ç«¯æ”¹ä¸ºä½¿ç”¨ `response.data.records`

#### 2. åˆ†é¡µæ•°æ®ç»“æ„ä¸ä¸€è‡´
- **é—®é¢˜**: å‰ç«¯å¤šå¤„ä½¿ç”¨ `.list` å­—æ®µè®¿é—®åˆ†é¡µæ•°æ®ï¼Œä½†åç«¯ç»Ÿä¸€è¿”å› `PageResult` ç»“æ„ï¼Œå­—æ®µåä¸º `records`
- **å½±å“**: åˆ†é¡µæ•°æ®æ— æ³•æ­£ç¡®æ˜¾ç¤º
- **ä¿®å¤å»ºè®®**: å‰ç«¯ç»Ÿä¸€ä½¿ç”¨ `records` å­—æ®µå

### ğŸŸ¢ è½»å¾®é—®é¢˜

#### 1. æ¥å£å‘½åä¸ä¸€è‡´
- **é—®é¢˜**: å‰ç«¯APIæ¨¡å—å‘½åä¸åç«¯Controllerè·¯å¾„ä¸å®Œå…¨å¯¹åº”
- **å½±å“**: ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§
- **ä¿®å¤å»ºè®®**: ç»Ÿä¸€å‰åç«¯æ¥å£å‘½åè§„èŒƒ

## ä¿®å¤ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ (ç«‹å³ä¿®å¤)
1. ä¿®å¤æ¨¡æ¿åˆ—è¡¨å“åº”å­—æ®µé—®é¢˜ (`response.data.list` â†’ `response.data.records`)
2. æ·»åŠ æˆ–ä¿®å¤æ”¶è—æ¨¡æ¿åŠŸèƒ½
3. ç»Ÿä¸€å†…å®¹ç”Ÿæˆæ¥å£è°ƒç”¨
4. æ·»åŠ ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢æ¥å£
5. ä¿®å¤å†å²è®°å½•æ¥å£è°ƒç”¨

### ä¸­ä¼˜å…ˆçº§ (è¿‘æœŸä¿®å¤)
1. æ·»åŠ ç”¨æˆ·ç»Ÿè®¡å’Œä¼šå‘˜ä¿¡æ¯æ¥å£
2. ç»Ÿä¸€å‰åç«¯æ¥å£å‘½åè§„èŒƒ
3. å®Œå–„APIæ–‡æ¡£

### ä½ä¼˜å…ˆçº§ (é•¿æœŸä¼˜åŒ–)
1. ä»£ç é‡æ„å’Œä¼˜åŒ–
2. æ¥å£æ€§èƒ½ä¼˜åŒ–

## å»ºè®®çš„ä¿®å¤æ­¥éª¤

1. **ç«‹å³ä¿®å¤å“åº”å­—æ®µé—®é¢˜**
   - ä¿®æ”¹ `wxmini/pages/templates/templates.js` ä¸­çš„ `response.data.list` ä¸º `response.data.records`
   - æ£€æŸ¥å…¶ä»–é¡µé¢æ˜¯å¦æœ‰ç±»ä¼¼é—®é¢˜

2. **åç«¯æ¥å£è¡¥å……**
   - æ·»åŠ æ”¶è—æ¨¡æ¿ç›¸å…³æ¥å£
   - æ·»åŠ ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢æ¥å£
   - æ·»åŠ ç”¨æˆ·ç»Ÿè®¡å’Œä¼šå‘˜ä¿¡æ¯æ¥å£

3. **å‰ç«¯APIè°ƒç”¨ç»Ÿä¸€**
   - ç»Ÿä¸€å†…å®¹ç”Ÿæˆæ¥å£è°ƒç”¨æ–¹å¼
   - ä¿®æ­£å†å²è®°å½•æ¥å£è°ƒç”¨è·¯å¾„
   - ç¡®ä¿æ‰€æœ‰APIè°ƒç”¨ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„å’Œå‚æ•°

4. **æµ‹è¯•éªŒè¯**
   - å¯¹ä¿®å¤çš„æ¥å£è¿›è¡ŒåŠŸèƒ½æµ‹è¯•
   - ç¡®ä¿å‰åç«¯æ•°æ®äº¤äº’æ­£å¸¸
   - éªŒè¯æ‰€æœ‰é¡µé¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ

## æ€»ç»“

é€šè¿‡æœ¬æ¬¡å¯¹æ¯”åˆ†æï¼Œå‘ç°äº†å¤šä¸ªå‰åç«¯æ¥å£ä¸åŒ¹é…çš„é—®é¢˜ï¼Œä¸»è¦é›†ä¸­åœ¨ï¼š
- å“åº”å­—æ®µåç§°ä¸ä¸€è‡´
- å‰ç«¯è°ƒç”¨ä¸å­˜åœ¨çš„åç«¯æ¥å£
- æ¥å£è·¯å¾„å’Œå‘½åä¸ç»Ÿä¸€

å»ºè®®æŒ‰ç…§ä¼˜å…ˆçº§é€æ­¥ä¿®å¤è¿™äº›é—®é¢˜ï¼Œç¡®ä¿å‰åç«¯æ¥å£çš„ä¸€è‡´æ€§å’Œç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚