# 艺术风格管理功能需求文档

## 1. 功能概述

将当前仅限于图片生成的艺术风格选择功能扩展为图片和视频的公共设置，通过后端数据库管理艺术风格，实现风格描述的自动拼接到用户prompt中。

## 2. 核心需求

### 2.1 数据库设计

创建艺术风格数据表 `art_style`：

| 字段名              | 类型           | 说明                    |
| ---------------- | ------------ | --------------------- |
| id               | BIGINT       | 主键，自增                 |
| name             | VARCHAR(50)  | 风格名称（如：动漫风、油画风）       |
| description      | VARCHAR(200) | 风格描述（用于拼接到prompt）     |
| applicable\_type | VARCHAR(20)  | 适用类型：image、video、both |
| sort\_order      | INT          | 排序权重                  |
| status           | TINYINT      | 状态：1-启用，0-禁用          |
| created\_at      | DATETIME     | 创建时间                  |
| updated\_at      | DATETIME     | 更新时间                  |

### 2.2 初始数据

预置常用艺术风格：

* 动漫风格：适用于图片和视频

* 油画风格：适用于图片和视频

* 水彩风格：适用于图片和视频

* 素描风格：适用于图片

* 写实风格：适用于图片和视频

* 卡通风格：适用于图片和视频

* 科幻风格：适用于图片和视频

* 古典风格：适用于图片和视频

### 2.3 后端API设计

#### 2.3.1 艺术风格管理接口

**获取艺术风格列表**

* 接口：`GET /api/art-styles`

* 参数：`type`（可选，筛选适用类型：image/video/both）

* 返回：风格列表

**根据ID获取艺术风格**

* 接口：`GET /api/art-styles/{id}`

* 返回：风格详情

**创建艺术风格**（管理员功能）

* 接口：`POST /api/art-styles`

* 参数：name, description, applicable\_type, sort\_order

**更新艺术风格**（管理员功能）

* 接口：`PUT /api/art-styles/{id}`

**删除艺术风格**（管理员功能）

* 接口：`DELETE /api/art-styles/{id}`

#### 2.3.2 内容生成接口修改

修改现有的内容生成接口，添加 `styleId` 参数：

* 图片生成：`POST /api/contents/generate/image`

* 视频生成：`POST /api/contents/generate/video`

### 2.4 Prompt拼接逻辑

当用户选择艺术风格时：

1. 前端传递 `styleId` 到后端
2. 后端根据 `styleId` 查询风格描述
3. 在用户输入的prompt前拼接：`风格为 {风格描述}，{用户prompt}`

**示例：**

* 用户选择：动漫风格

* 用户输入：一只可爱的小猫

* 最终prompt：风格为 动漫风，一只可爱的小猫

## 3. 前端改造

### 3.1 Generate页面修改

**当前实现：**

* 艺术风格仅在图片类型下显示

* 使用文本输入框

**改造后：**

* 艺术风格移至公共设置区域

* 图片和视频都可以选择

* 改为下拉选择框，显示预定义的艺术风格

* 添加"无风格"选项

### 3.2 组件结构调整

```
基础设置区域：
├── 生成类型（图片/视频）
├── 艺术风格（新增公共设置）
├── 参考图片
└── 水印选项

高级参数区域：
├── 图片参数（尺寸、质量、随机种子等）
└── 视频参数（分辨率、时长、比例等）
```

### 3.3 API调用修改

修改前端API调用，传递选中的风格ID：

```javascript
const params = {
  // 其他参数...
  styleId: selectedStyleId // 新增风格ID参数
};
```

## 4. 技术实现要点

### 4.1 后端实现

1. **实体类**：创建 `ArtStyle` 实体
2. **Mapper**：创建 `ArtStyleMapper` 接口
3. **Service**：创建 `ArtStyleService` 服务层
4. **Controller**：创建 `ArtStyleController` 控制器
5. **数据库迁移**：创建建表SQL和初始数据SQL

### 4.2 前端实现

1. **API接口**：在 `api.ts` 中添加艺术风格相关接口
2. **状态管理**：创建或扩展store管理艺术风格数据
3. **组件改造**：修改Generate页面的艺术风格选择组件
4. **类型定义**：添加艺术风格相关的TypeScript类型

### 4.3 数据流程

1. 页面加载时获取艺术风格列表
2. 根据当前生成类型筛选可用风格
3. 用户选择风格后更新状态
4. 生成内容时传递风格ID
5. 后端根据风格ID拼接prompt

## 5. 验收标准

1. ✅ 图片和视频生成都可以选择艺术风格
2. ✅ 艺术风格通过下拉框选择，不再是文本输入
3. ✅ 后端成功创建艺术风格数据表
4. ✅ 风格描述正确拼接到用户prompt前
5. ✅ 提供艺术风格的CRUD管理接口
6. ✅ 初始化预设的艺术风格数据
7. ✅ 前端界面布局合理，用户体验良好

## 6. 后续扩展

* 支持自定义艺术风格

* 艺术风格预览图片

* 风格推荐功能

* 风格使用统计

